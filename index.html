<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>NewJeans Y2K Experience</title>
    <style>
        /* ä¿æŒåŸæœ‰æ ·å¼ä¸å˜ */
        :root {
          --nj-pink: #ff9dbb;
          --nj-blue: #8ac7ff;
        }

        body {
          background: #0000AA url("images/bg/matrix-bg.gif");
          color: #00FF00;
          font-family: 'MS Sans Serif', 'Microsoft Sans Serif', 'SimSun', 'Microsoft YaHei', sans-serif;
          overflow: hidden;
          margin: 0;
        }

        .crt::after {
          content: "";
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
            linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
          pointer-events: none;
        }

        .windows98-panel {
          position: fixed;
          border: 3px solid;
          border-color: #FFFFFF #808080 #808080 #FFFFFF;
          background: #C0C0C0;
          box-shadow: 5px 5px 10px rgba(0,0,0,0.5);
          cursor: default;
          z-index: 1;
        }

        .windows98-panel.active-window {
          z-index: 999;
        }

        .title-bar {
          background: linear-gradient(90deg, #000080, #1084d0);
          padding: 4px;
          display: flex;
          justify-content: space-between;
          align-items: center;
          cursor: move;
        }

        .member-container {
          position: relative;
          display: inline-block;
          margin: 10px;
        }

        .member-pixel {
          width: 64px;
          height: 64px;
          image-rendering: pixelated;
          border: 2px solid var(--nj-pink);
          margin: 5px;
          cursor: pointer;
          transition: transform 0.2s;
        }

        .member-pixel:hover {
          transform: scale(1.1);
          border-color: var(--nj-blue);
        }

        .member-name {
          position: absolute;
          bottom: -15px;
          left: 50%;
          transform: translateX(-50%);
          font-size: 0.8em;
          color: white;
          text-shadow: 1px 1px black;
          white-space: nowrap;
        }

        #tamagochi {
          background: #FFF;
          border: 2px inset;
          padding: 15px;
          margin: 10px;
        }

        .pet {
          width: 64px;
          height: 64px;
          background: url('images/pet/pixel-pet.gif') no-repeat;
          image-rendering: pixelated;
          margin: 10px auto;
        }

        #taskbar {
          position: fixed;
          bottom: 0;
          width: 100%;
          background: #C0C0C0;
          border-top: 2px solid #FFF;
          display: flex;
          justify-content: space-between;
          padding: 2px;
          font-family: 'MS Sans Serif', sans-serif;
        }

        .floating-album {
          position: absolute;
          animation: float 3s ease-in-out infinite;
          filter: sepia(0.3) contrast(1.2);
          width: 80px;
        }

        @keyframes float {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }

        .lyrics-box {
          background: rgba(0, 0, 0, 0.7);
          border: 1px dashed var(--nj-blue);
          padding: 10px;
          position: fixed;
          right: 20px;
          top: 50%;
          transform: translateY(-50%);
          width: 200px;
          font-family: 'MS Sans Serif', sans-serif;
        }

.note {
  image-rendering: pixelated;
  box-shadow: 0 0 8px rgba(255,255,255,0.5);
}

#game-area {
    height: 300px;
    background: black url('images/icons/game-icon.gif') no-repeat center center !important;
    background-size: cover !important;
    position: relative;
    overflow: hidden;
    border: 3px solid #808080;
    image-rendering: pixelated;
}

.lane {
    width: 25%;
    height: 100%;
    border-left: 1px solid rgba(255,255,255,0.2);
    border-right: 1px solid rgba(255,255,255,0.2);

/* æ·»åŠ CRTæ‰«æçº¿åŠ¨ç”» */
@keyframes scanline {
  from { transform: translateY(-100%); }
  to { transform: translateY(100%); }
}
#game-area::after {
  content: "";
  position: absolute;
  width: 100%;
  height: 100%;
  background: linear-gradient(
    to bottom,
    rgba(255,255,255,0.1) 0%,
    rgba(0,0,0,0.2) 10%,
    transparent 30%
  );
  animation: scanline 2s linear infinite;
  pointer-events: none;
}
button.pixel-font {
  font-family: 'MS Sans Serif', sans-serif;
  font-size: 14px;
  color: #000;
}

button.pixel-font:hover {
  background: #A0A0A0;
  border-color: #808080 #FFF #FFF #808080;
}
        @keyframes moveGameIcon {
    0% { transform: translateX(-50%) translateY(0); }
    100% { transform: translateX(-50%) translateY(30px); }
}
        #members-container {
    display: flex;
    flex-wrap: nowrap;  /* ç¦æ­¢æ¢è¡Œ */
    justify-content: flex-start;  /* ä»å·¦å‘å³æ’åˆ— */
    align-items: center;
    gap: 10px;  /* å¤´åƒä¹‹é—´çš„é—´è· */
    overflow-x: auto; /* å…è®¸æ¨ªå‘æ»šåŠ¨ */
    max-width: 100%;
}
        #unlocked-members {
    min-height: 150px; /* é™åˆ¶æœ€å°é«˜åº¦ */
    height: auto;
    padding: 15px;
}

    </style>
</head>
<body>
<div class="crt">
    <!-- æ¡Œé¢å›¾æ ‡ -->
    <div class="desktop-icon" ondblclick="openMediaPlayer()" style="position: absolute; left: 20px; top: 20px;">
        <img alt="NewJeans Disc" src="images/icons/cd-icon.gif" style="width:48px;height:48px">
        <div class="pixel-font" style="color: white;">NewJeans_Disc</div>
    </div>

    <!-- ä¸»ç³»ç»Ÿçª—å£ -->
    <div class="windows98-panel" style="left: 50px; top: 100px; width: 300px;">
        <div class="title-bar">
            <span class="pixel-font">SYSTEM_INFO.EXE</span>
            <div class="controls">â</div>
        </div>
        <div class="content">
            <img alt="Loading..." src="images/loading.gif" style="width: 100px;">
            <p class="pixel-font">Booting NewJeans OS...</p>
        </div>
    </div>

    <!-- è™šæ‹Ÿå® ç‰©çª—å£ -->
    <div class="windows98-panel" style="left: 400px; top: 80px; width: 200px;">
        <div class="title-bar">
            <span class="pixel-font">DIGI_PET.EXE</span>
            <div class="controls">â</div>
        </div>
        <div id="tamagochi">
            <div class="pet"></div>
            <div class="pixel-font" id="pet-status">HUNGER: â–°â–°â–°â–°â–°<br>MOOD: â–°â–°â–°â–°â–°</div>
            <button class="pixel-font" onclick="feed()">ğŸ® Feed</button>
            <button class="pixel-font" onclick="play()">ğŸ•¹ï¸ Play</button>
        </div>
    </div>

    <!-- æˆå‘˜äº’åŠ¨çª—å£ -->
    <div class="windows98-panel" style="left: 100px; top: 300px; width: 400px;">
        <div class="title-bar">
            <span class="pixel-font">MEMBERS_1999.EXE</span>
            <div class="controls">â</div>
        </div>
        <div class="content" style="text-align: center;">
            <div class="member-container">
                <img alt="MINJI" class="member-pixel" onclick="showBio('minji')" src="images/members/minji.png">
                <div class="member-name pixel-font">MINJI</div>
            </div>
            <div class="member-container">
                <img alt="HANNI" class="member-pixel" onclick="showBio('hanni')" src="images/members/hanni.png">
                <div class="member-name pixel-font">HANNI</div>
            </div>
            <div class="member-container">
                <img alt="DANIELLE" class="member-pixel" onclick="showBio('danielle')"
                     src="images/members/danielle.png">
                <div class="member-name pixel-font">DANIELLE</div>
            </div>
            <div class="member-container">
                <img alt="HAERIN" class="member-pixel" onclick="showBio('haerin')" src="images/members/haerin.png">
                <div class="member-name pixel-font">HAERIN</div>
            </div>
            <div class="member-container">
                <img alt="HYEIN" class="member-pixel" onclick="showBio('hyein')" src="images/members/hyein.png">
                <div class="member-name pixel-font">HYEIN</div>
            </div>
            <div class="pixel-font" id="member-bio" style="margin: 15px; color: #000;"></div>
        </div>
    </div>

    <!-- NewJeans å›¢ä½“ç…§ç‰‡çª—å£ -->
<div class="windows98-panel" style="left: 100px; top: 600px; width: 400px;">
    <div class="title-bar">
        <span class="pixel-font">ğŸ“¸ NJ_GROUP_PHOTOS.EXE</span>
        <div class="controls">â</div>
    </div>
    <div class="content" style="text-align: center;">
        <img id="group-photo" src="images/group/group1.jpg" style="width: 100%; border: 2px solid #000;">
        <div style="margin-top: 10px;">
            <button class="pixel-font" onclick="prevPhoto()">â¬… ä¸Šä¸€å¼ </button>
            <button class="pixel-font" onclick="nextPhoto()">ä¸‹ä¸€å¼  â¡</button>
        </div>
    </div>
</div>

    <!-- éŸ³ä¹æ’­æ”¾å™¨çª—å£ -->
    <div class="windows98-panel" style="left: 600px; top: 150px; width: 320px;">
        <div class="title-bar">
            <span class="pixel-font">BUNNY_JAMMER.EXE</span>
            <div class="controls">â</div>
        </div>
        <div class="content">
            <div style="position: relative; height: 100px;">
                <img class="floating-album" src="images/albums/hypeboy.gif" style="left:10%">
                <img class="floating-album" src="images/albums/ditto.gif" style="left:60%;animation-delay:1s">
            </div>
            <audio controls id="nj-player" style="width:100%">
                <source src="audio/newjeans-hypeboy.mp3" type="audio/mp3">
            </audio>
            <div class="lyrics-box pixel-font" id="lyrics"></div>
        </div>
    </div>

    <!-- åœ¨ç°æœ‰HTMLçš„windows98-panelåŒºåŸŸæ·»åŠ  -->
    <div class="windows98-panel" style="left: 250px; top: 450px; width: 480px;">
        <div class="title-bar">
            <span class="pixel-font">ğŸµ RHYTHM_BUNNY.EXE</span>
            <div class="controls">â</div>
        </div>
        <div class="content" style="padding:10px">
            <div class="pixel-font" style="text-align:center; margin:5px">
                ğŸ•¹ï¸ éš¾åº¦ï¼š<select id="difficulty" style="background:#C0C0C0; border:2px inset">
                <option>EASY</option>
                <option>NORMAL</option>
                <option>HARD</option>
            </select>
                ğŸ† æœ€é«˜åˆ†ï¼š<span id="highscore">0</span>
            </div>
            <div style="text-align: center; margin: 10px 0;">
                <button id="start-game-btn" class="pixel-font" id="start-game-btn"
                        onclick="game.start()"
                        style="background: #C0C0C0;
                           border: 2px outset #FFF #808080 #808080 #FFF;
                           padding: 6px 12px;
                           cursor: pointer;">
                    â–¶ START GAME
                </button>
                <button class="pixel-font"
                        onclick="game.stop()"
                        style="background: #C0C0C0;
                 border: 2px outset #FFF #808080 #808080 #FFF;
                 padding: 6px 12px;
                 cursor: pointer;
                 margin-left: 10px;">
                    â¹ STOP GAME
                </button>
            </div>

<!-- ğŸ€ æˆå‘˜è§£é”çª—å£ -->
<div id="unlocked-members" class="windows98-panel"
     style="position: absolute; left: 750px; top: 150px; width: 300px; ">
    <div class="title-bar">
        <span class="pixel-font">ğŸŒŸ UNLOCKED MEMBERS</span>
        <button id="close-members-btn"
                style="float: right; background: none; color: white; border: none; cursor: pointer;">â</button>
    </div>
    <div class="content pixel-font" style="text-align: center; background: white; padding: 10px;">
        <p>ğŸ’åœ¨Rhythm Bunnyè¾¾åˆ°é«˜åˆ† æ”¶é›†æˆå‘˜å¤§å¤´è´´ï¼</p>
        <div id="members-container"></div>
    </div>
</div>

<!-- ğŸµ â€œæ¸¸ç©æŒ‡å—â€ æŒ‰é’® -->
<button id="show-guide-btn" class="pixel-font"
        style="background: #C0C0C0; border: 2px outset #FFF #808080 #808080 #FFF;
               padding: 6px 12px; cursor: pointer; margin-top: 10px;">
    ğŸ“– æ¸¸ç©æŒ‡å—
</button>

<!-- ğŸ® æ¸¸ç©æŒ‡å—çª—å£ -->
<div id="game-guide" class="windows98-panel"
     style="display: none; position: fixed; left: 50%; top: 50%;
            transform: translate(-50%, -50%);
            width: 400px; padding: 10px; z-index: 1000;">
    <div class="title-bar">
        <span class="pixel-font">ğŸ“– Rhythm Bunny - æ¸¸ç©æŒ‡å—</span>
        <button id="close-guide-btn"
                style="float: right; background: red; color: white; border: none; cursor: pointer;">â</button>
    </div>
    <div class="content pixel-font" style="max-height: 300px; overflow-y: auto; background: white; padding: 10px;">
        <p><strong>ğŸ¯ æ¸¸æˆç›®æ ‡ï¼š</strong> å‰å¥ç»“æŸåæŒ‰é”®å‡»æ‰“éŸ³ç¬¦ï¼Œä¿æŒè¿å‡»ï¼ŒæŒ‘æˆ˜é«˜åˆ†ï¼</p>
        <p><strong>ğŸ® æ“ä½œæ–¹å¼ï¼š</strong></p>
        <ul>
            <li><strong>A</strong> - ç¬¬ä¸€è½¨é“</li>
            <li><strong>S</strong> - ç¬¬äºŒè½¨é“</li>
            <li><strong>D</strong> - ç¬¬ä¸‰è½¨é“</li>
            <li><strong>F</strong> - ç¬¬å››è½¨é“</li>
        </ul>
        <p>è·ŸéšéŸ³ä¹æŒ‰é”®ï¼ŒéŸ³ç¬¦è¿›å…¥æ¥è¿‘åº•éƒ¨çš„åˆ¤å®šåŒºæ—¶å‡»æ‰“ï¼</p>
        <p><strong>ğŸ”¥ å°æŠ€å·§ï¼š</strong> è¿å‡»è¶Šé«˜ï¼Œå¾—åˆ†åŠ æˆè¶Šé«˜ï¼</p>
    </div>
</div>

            <div id="game-area"
                 style="height:300px; background:black; position:relative; overflow:hidden;
                border:3px solid #808080; image-rendering:pixelated">
                <!-- éŸ³ç¬¦å°†åŠ¨æ€ç”Ÿæˆåœ¨æ­¤ -->
            </div>
            <div class="pixel-font" style="text-align:center; margin:5px">
                ğŸ”¥ COMBO: <span id="combo">0</span>
                ğŸ’¯ SCORE: <span id="score">0</span>
            </div>
        </div>
    </div>

    <!-- çŠ¶æ€æ  -->
    <div id="taskbar">
        <div class="pixel-font">ğŸ“» NewJeans OS v1.0</div>
        <div class="pixel-font" id="clock">ğŸ•’ 00:00 AM</div>
    </div>
</div>

<script>
    // ä½¿ç”¨é—­åŒ…éš”ç¦»æ‹–æ‹½ç³»ç»Ÿ
   (function() {
     // æ‹–æ‹½çŠ¶æ€ç®¡ç†å™¨ï¼ˆé¿å…å…¨å±€æ±¡æŸ“ï¼‰
     const dragManager = {
       isDragging: false,
       currentWindow: null,
       startX: 0,
       startY: 0,
       offsetX: 0,
       offsetY: 0
     };

     // çª—å£å±‚çº§è®¡æ•°å™¨
     let zIndexCounter = 100;

     // åˆå§‹åŒ–æ‰€æœ‰çª—å£
     function initWindows() {
       document.querySelectorAll('.windows98-panel').forEach(win => {
         win.style.zIndex = zIndexCounter++;
         win.querySelector('.title-bar').addEventListener('mousedown', startDrag);
       });
     }

     // å¼€å§‹æ‹–æ‹½
     function startDrag(e) {
       e.stopPropagation();

       dragManager.isDragging = true;
       dragManager.currentWindow = e.target.closest('.windows98-panel');
       dragManager.currentWindow.style.zIndex = zIndexCounter++;

       const rect = dragManager.currentWindow.getBoundingClientRect();
       dragManager.startX = e.clientX;
       dragManager.startY = e.clientY;
       dragManager.offsetX = e.clientX - rect.left;
       dragManager.offsetY = e.clientY - rect.top;
     }

     // å¤„ç†æ‹–æ‹½ä¸­
     function handleDrag(e) {
       if (!dragManager.isDragging) return;

       const newX = e.clientX - dragManager.offsetX;
       const newY = e.clientY - dragManager.offsetY;

       dragManager.currentWindow.style.left = `${newX}px`;
       dragManager.currentWindow.style.top = `${newY}px`;
     }

     // ç»“æŸæ‹–æ‹½
     function stopDrag() {
       dragManager.isDragging = false;
       dragManager.currentWindow = null;
     }

     // äº‹ä»¶ç»‘å®šï¼ˆä½¿ç”¨passiveæ”¹å–„æ€§èƒ½ï¼‰
     document.addEventListener('mousemove', handleDrag, { passive: true });
     document.addEventListener('mouseup', stopDrag);
     window.addEventListener('load', initWindows);

     // æš´éœ²å¿…è¦æ¥å£ç»™æ¸¸æˆ
     window.windowManager = {
       bringToFront: (win) => {
         win.style.zIndex = zIndexCounter++;
       }
     };
   })();

       // ä¿®å¤åçš„å® ç‰©ç³»ç»Ÿ
       let petStats = { hunger: 5, mood: 5 };

       // è‡ªåŠ¨å‡å°‘çŠ¶æ€
       function autoDecrease() {
         setInterval(() => {
           petStats.hunger = Math.max(0, petStats.hunger - 1);
           petStats.mood = Math.max(0, petStats.mood - 1);
           updatePet();
         }, 30000); // æ¯30ç§’å‡å°‘1ç‚¹
       }

       function feed() {
         petStats.hunger = Math.min(5, petStats.hunger + 1); // æ¯æ¬¡å–‚å…»+1
         updatePet();
       }

       function play() {
         petStats.mood = Math.min(5, petStats.mood + 1); // æ¯æ¬¡ç©è€+1
         updatePet();
       }

       function updatePet() {
         const statusElement = document.getElementById("pet-status");
         statusElement.innerHTML =
           `HUNGER: ${'â–°'.repeat(petStats.hunger)}${'â–±'.repeat(5 - petStats.hunger)}<br>
            MOOD: ${'â–°'.repeat(petStats.mood)}${'â–±'.repeat(5 - petStats.mood)}`;

         // æ·»åŠ è§†è§‰åé¦ˆ
         statusElement.style.color = petStats.hunger <= 2 ? "#FF0000" : "#00FF00";
         statusElement.style.textShadow = petStats.mood <= 2 ? "0 0 5px red" : "none";
       }

       // åœ¨é¡µé¢åŠ è½½äº‹ä»¶ç›‘å¬å™¨ä¸­æ·»åŠ  â†“â†“â†“
       window.addEventListener('load', () => {
         updateClock();
         autoDecrease(); // æ–°å¢çš„åˆå§‹åŒ–è°ƒç”¨
         document.querySelectorAll('.windows98-panel').forEach((win, index) => {
           win.style.zIndex = 100 + index;
         });
       });

       // æˆå‘˜ç®€ä»‹ç³»ç»Ÿ
       const members = {
         minji: { bio: "ğŸ»\n ğŸ‘‘ Digital Leader\nğŸ‚ 2004.05.07" },
         hanni: { bio: "ğŸ¦­\n ğŸ¤ Melody Master\nğŸ‚ 2004.10.06" },
         danielle: { bio: "ğŸ¶\n âœ¨ Sunshine Energy\nğŸ‚ 2005.04.11" },
         haerin: { bio: "ğŸˆâ€â¬›\n ğŸ˜¼ Cat-like Charisma\nğŸ‚ 2006.05.15" },
         hyein: { bio: "ğŸ¹\n ğŸ‡ Maknae Power\nğŸ‚ 2008.04.21" }
       };

       function showBio(member) {
         document.getElementById("member-bio").innerText = members[member].bio;
       }

       // ç³»ç»Ÿæ—¶é’Ÿ
       function updateClock() {
         const timeString = new Date().toLocaleTimeString('en-US', {
           hour: 'numeric',
           minute: '2-digit'
         });
         document.getElementById("clock").innerHTML = `ğŸ•’ ${timeString}`;
       }
       setInterval(updateClock, 1000);

       // æ­Œè¯åŒæ­¥ç¤ºä¾‹
       const hypeboyLyrics = [
         { time: 18.01, text: "One, two, three, four" },
         { time: 19.39, text: "Baby (baby)" },
         { time: 20.60, text: "Got me looking so crazy (crazy)" },
         { time: 23.15, text: "ë¹ ì ¸ë²„ë¦¬ëŠ” daydream (daydream)" },
         { time: 25.35, text: "Got me feeling you, ë„ˆë„ ë§í•´ì¤„ë˜?" },
         { time: 29.25, text: "ëˆ„ê°€ ë‚´ê²Œ ë­ë¼ë“ , ë‚¨ë“¤ê³¼ëŠ” ë‹¬ë¼ ë„Œ" },
         { time: 31.65, text: "Maybe you could be the one (one)" },
         { time: 33.98, text: "ë‚  ë¯¿ì–´ë´ í•œë²ˆ, I'm not looking for just fun" },
         { time: 36.42, text: "Maybe I could be the one" },
         { time: 38.03, text: "Oh, baby, ì˜ˆë¯¼í•˜ëŒ€ ë‚˜ lately" },
         { time: 42.23, text: "ë„ˆ ì—†ì´ëŠ” ë§¤ì¼ ë§¤ì¼ì´, yeah, ì¬ë¯¸ì—†ì–´, ì–´ì©Œì§€?" },
         { time: 48.38, text: "I just want you call my phone right now" },
         { time: 50.53, text: "I just wanna hear \"you're mine\"" },
         { time: 52.90, text: "'Cause I know what you like, boy (ah-ah)" },
         { time: 57.52, text: "You're my chemical hype boy (ah-ah)" },
         { time: 62.43, text: "ë‚´ ì§€ë‚œë‚ ë“¤ì€, ëˆˆ ëœ¨ë©´ ìŠëŠ” ê¿ˆ" },
         { time: 67.68, text: "Hype boy, ë„ˆë§Œ ì›í•´, hype boy, ë‚´ê°€ ì „í•´" },
         { time: 71.57, text: "And we can go high" },
         { time: 74.15, text: "ë§í•´ë´, yeah, ëŠê»´ë´, mmm, mmm" },
         { time: 76.49, text: "Take him to the sky" },
         { time: 79.03, text: "You know, I hype you, boy" },
         { time: 81.08, text: "ëˆˆì„ ê°ì•„" },
         { time: 83.56, text: "ë§í•´ë´, yeah, ëŠê»´ë´, mmm, mmm" },
         { time: 85.85, text: "Take him to the sky" },
         { time: 88.43, text: "You know, I hype you, boy" },
         { time: 94.25, text: "ì ì— ë“¤ë ¤ê³ , ì ì— ë“¤ë ¤ í•´ë„" },
         { time: 96.64, text: "ë„¤ ìƒê°ì— ë˜ ìƒˆë²½ ì„¸ ì‹œ, uh-oh" },
         { time: 99.00, text: "ì•Œë ¤ì¤„ ê±°ì•¼, they can't have you no more" },
         { time: 101.66, text: "ë´ë´ ì—¬ê¸° ë‚´ ì´ë¦„ ì¨ìˆë‹¤ê³ , yeah" },
         { time: 106.07, text: "ëˆ„ê°€ ë‚´ê²Œ ë­ë¼ë“ , ë‚¨ë“¤ê³¼ëŠ” ë‹¬ë¼ ë„Œ" },
         { time: 108.51, text: "Maybe you could be the one (one)" },
         { time: 110.68, text: "ë‚  ë¯¿ì–´ë´ í•œë²ˆ, I'm not looking for just fun" },
         { time: 113.25, text: "Maybe I could be the one" },
         { time: 114.81, text: "Oh, baby, ì˜ˆë¯¼í•˜ëŒ€ ë‚˜ lately" },
         { time: 119.03, text: "ë„ˆ ì—†ì´ëŠ” ë§¤ì¼ ë§¤ì¼ì´, yeah, ì¬ë¯¸ì—†ì–´, ì–´ì©Œì§€?" },
         { time: 124.91, text: "I just want you call my phone right now" },
         { time: 127.37, text: "I just wanna hear \"you're mine\"" },
         { time: 129.59, text: "'Cause I know what you like, boy (ah-ah)" },
         { time: 134.29, text: "You're my chemical hype boy (ah-ah)" },
         { time: 139.39, text: "ë‚´ ì§€ë‚œë‚ ë“¤ì€, ëˆˆ ëœ¨ë©´ ìŠëŠ” ê¿ˆ" },
         { time: 144.42, text: "Hype boy, ë„ˆë§Œ ì›í•´, hype boy, ë‚´ê°€ ì „í•´" },
         { time: 148.13, text: "And we can go high" },
         { time: 150.78, text: "ë§í•´ë´, yeah, ëŠê»´ë´, mmm, mmm" },
         { time: 153.15, text: "Take him to the sky" },
         { time: 155.74, text: "You know, I hype you, boy" },
         { time: 158.30, text: "ëˆˆì„ ê°ì•„" },
         { time: 160.39, text: "ë§í•´ë´, yeah, ëŠê»´ë´, mmm, mmm" },
         { time: 162.52, text: "Take him to the sky" },
         { time: 165.18, text: "You know, I hype you, boy" }
       ];

       document.getElementById("nj-player").ontimeupdate = function() {
         const currentTime = this.currentTime;

         // æ–¹æ³•1ï¼šreduce æŸ¥æ‰¾
         const currentLyric = hypeboyLyrics.reduce((last, cur) =>
           cur.time <= currentTime ? cur : last, null
         );

         // æ–¹æ³•2ï¼šåå‘æŸ¥æ‰¾ï¼ˆå¤‡é€‰ï¼‰
         // const currentLyric = [...hypeboyLyrics].reverse().find(l => l.time <= currentTime);

         document.getElementById("lyrics").innerHTML = currentLyric?.text || "â™ª â™« â™ª";
       };

       // åˆå§‹åŒ–
       window.addEventListener('load', () => {
         updateClock();
         document.querySelectorAll('.windows98-panel').forEach((win, index) => {
           win.style.zIndex = 100 + index;
         });
       });

class RhythmGame {
  constructor() {
    this.isPlaying = false;
    this.notes = [];
    this.generatedNotes = new Set();
    this.score = 0;
    this.combo = 0;
    this.highScore = parseInt(localStorage.getItem('njHighScore')) || 0;
    this.keyMap = { 'a':1, 's':2, 'd':3, 'f':4 };
    this.noteSpeed = 3;
     this.unlockedMembers = new Set(); // å­˜å‚¨å·²è§£é”çš„æˆå‘˜
        this.memberPhotos = {
            2000: { name: "Minji", image: "images/unlocked_members/minji.png" },
            4800: { name: "Hanni", image: "images/unlocked_members/hanni.png" },
            7200: { name: "Danielle", image: "images/unlocked_members/danielle.png" },
            10000: { name: "Haerin", image: "images/unlocked_members/haerin.png" },
            12000: { name: "Hyein", image: "images/unlocked_members/hyein.png" }
        };
    this.lastNoteTime = 0;
    this.song = new Audio('audio/newjeans-NewJeans.mp3');
    this.gameArea = document.getElementById('game-area');

    this.renderHighScore();
    document.addEventListener('keypress', this.handleInput.bind(this));
  }

  renderHighScore() {
    document.getElementById('highscore').textContent = this.highScore;
  }

start() {
    if (this.isPlaying) return;
    this.isPlaying = true;
    this.generatedNotes.clear();

    this.reset();
    this.song.currentTime = 0;
    this.song.play();
    this.isPlaying = true;

    if (!this.difficultyBound) {
        document.getElementById('difficulty').addEventListener('change', () => this.setDifficulty());
        this.difficultyBound = true;
    }

    this.gameLoop();
    this.setDifficulty();
    this.addGameIcon();
}

    gameLoop() {
        if (!this.isPlaying) return;
        this.generateNotes();
        this.updateNotes();
        requestAnimationFrame(() => this.gameLoop());
    }

  setDifficulty() {
    const diff = document.getElementById('difficulty').value;
    this.noteSpeed = { EASY:2, NORMAL:3, HARD:4 }[diff];
  }

    generateNotes() {
        if (!this.song) return console.error("æ­Œæ›²æœªæ­£ç¡®åŠ è½½ï¼");
        const currentTime = this.song.currentTime;

const beatMap = [
    { time: 14.41, lane: 3 },
    { time: 16.37, lane: 1 },
    { time: 18.28, lane: 4 },
    { time: 20.07, lane: 2 },
    { time: 22.17, lane: 1 },
    { time: 23.88, lane: 3 },
    { time: 25.92, lane: 4 },
    { time: 27.58, lane: 2 },
    { time: 29.28, lane: 1 },
    { time: 31.12, lane: 3 },
    { time: 31.34, lane: 2 },
    { time: 32.96, lane: 4 },
    { time: 34.41, lane: 1 },
    { time: 36.01, lane: 2 },
    { time: 37.84, lane: 3 },
    { time: 39.64, lane: 1 },
    { time: 41.46, lane: 4 },
    { time: 43.24, lane: 2 },
    { time: 44.93, lane: 3 },
    { time: 46.83, lane: 1 },
    { time: 48.55, lane: 4 },
    { time: 50.20, lane: 2 },
    { time: 51.99, lane: 3 },
    { time: 54.02, lane: 1 },
    { time: 55.49, lane: 4 },
    { time: 57.58, lane: 2 },
    { time: 58.98, lane: 3 },
    { time: 61.15, lane: 1 },
    { time: 62.50, lane: 4 },
    { time: 64.66, lane: 2 },
    { time: 64.88, lane: 3 },
    { time: 66.59, lane: 1 },
    { time: 68.35, lane: 4 },
    { time: 70.17, lane: 2 },
    { time: 72.08, lane: 3 },
    { time: 74.12, lane: 1 },
    { time: 76.38, lane: 4 },
    { time: 78.52, lane: 2 },
    { time: 80.79, lane: 3 },
    { time: 82.41, lane: 1 },
    { time: 84.26, lane: 4 },
    { time: 86.12, lane: 2 },
    { time: 88.49, lane: 3 },
    { time: 90.13, lane: 1 },
    { time: 92.30, lane: 4 },
    { time: 94.42, lane: 2 },
    { time: 96.75, lane: 3 },
    { time: 98.91, lane: 1 }
];

    beatMap.forEach(beat => {
                const noteKey = `${beat.time}-${beat.lane}`;
        if (currentTime < beat.time && beat.time - currentTime < 0.2) {
        if (!this.generatedNotes.has(beat.time))
    console.log(`ç”ŸæˆéŸ³ç¬¦ -> è½¦é“ ${beat.lane}, æ—¶é—´: ${beat.time}`);
            this.createNote(beat.lane);
            this.generatedNotes.add(beat.time);
        }
    });
}

showUnlockedMember(score) {
    const memberData = this.memberPhotos[score];
    if (!memberData) return;

    const unlockedWin = document.getElementById("unlocked-members");
    unlockedWin.style.display = "block";

        // âœ… å–æ¶ˆä¸ RhythmGame ç»‘å®š
    unlockedWin.style.position = "fixed";  // ç¡®ä¿å®ƒç›¸å¯¹è§†å£å®šä½ï¼Œè€Œä¸æ˜¯å…¶ä»–å…ƒç´ 
    unlockedWin.style.zIndex = "1000";     // ç¡®ä¿å®ƒåœ¨æœ€å‰é¢
    unlockedWin.style.margin = "0";        // é˜²æ­¢å¤–éƒ¨å½±å“

    // è®¡ç®—çª—å£å±…ä¸­ï¼Œå¹¶ç¡®ä¿ä¸ä¼šè¶…å‡ºè§†å£
    const winWidth = unlockedWin.offsetWidth;
    const winHeight = unlockedWin.offsetHeight;
    let left = (window.innerWidth - winWidth) / 2;
    let top = (window.innerHeight - winHeight) / 2;

    left = Math.max(0, Math.min(left, window.innerWidth - winWidth));
    top = Math.max(0, Math.min(top, window.innerHeight - winHeight));

    // ç»‘å®šæ‹–åŠ¨
    const titleBar = unlockedWin.querySelector('.title-bar');
    if (titleBar) makeDraggable(unlockedWin, titleBar);

    // è®©çª—å£å§‹ç»ˆæ¨ªå‘å¢é•¿
    unlockedWin.style.whiteSpace = "nowrap";
    unlockedWin.style.width = "auto";
    unlockedWin.style.maxWidth = "90vw"; // é˜²æ­¢è¶…å‡ºå±å¹•

    // åˆ›å»ºæ–°æˆå‘˜ç…§ç‰‡
    const img = document.createElement("img");
    img.src = memberData.image;
    img.style.cssText = "width: 80px; margin: 5px; image-rendering: pixelated;";
    img.alt = memberData.name;

    // åŠ å…¥æˆå‘˜å±•ç¤ºåŒº
    document.getElementById("members-container").appendChild(img);

    // æ˜¾ç¤ºè§£é”çª—å£ï¼Œä½†ä¸å½±å“æ¸¸æˆ
    document.getElementById("unlocked-members").style.display = "flex";

    // ğŸ‰ æ–°å¢è§£é”æç¤ºï¼Œä¸æ‰“æ–­æ¸¸æˆ
    const unlockMessage = document.createElement("div");
    unlockMessage.textContent = `ğŸ‰ è§£é” ${memberData.name}ï¼`;
    unlockMessage.style.cssText = `
        position: fixed; top: 10px; left: 50%; transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.8); color: white; padding: 10px 20px;
        border-radius: 5px; font-size: 14px; z-index: 9999;
    `;
    document.body.appendChild(unlockMessage);

    // 3 ç§’åè‡ªåŠ¨æ¶ˆå¤±
    setTimeout(() => unlockMessage.remove(), 3000);

    document.getElementById("close-members-btn").addEventListener("click", () => {
    document.getElementById("unlocked-members").style.display = "none";
});

}



  stop() {
    if (!this.isPlaying) return;

    // åœæ­¢éŸ³ä¹
    this.song.pause();
    this.song.currentTime = 0;

    // åœæ­¢æ¸¸æˆå¾ªç¯
    this.isPlaying = false;

    // æ¸…é™¤æ‰€æœ‰éŸ³ç¬¦
    this.notes.forEach(note => note.element.remove());
    this.notes = [];

    // é‡ç½®è¿å‡»å’Œåˆ†æ•°æ˜¾ç¤º
    this.combo = 0;
    this.updateDisplay();

    // ğŸ¯ ç§»é™¤ game-icon
    const gameIcon = document.getElementById('game-icon');
    if (gameIcon) gameIcon.remove();

    // æ˜¾ç¤ºæ¸¸æˆå·²åœæ­¢çš„æç¤º
    console.log("æ¸¸æˆå·²åœæ­¢");
  }

createNote(lane) {
    const note = document.createElement('div');
    note.className = 'note';
    note.style.cssText = `
        width: 40px;
        height: 20px;
        background: ${['#FF69B4','#7FFF00','#00BFFF','#FFD700'][lane-1]};
        position: absolute;
        left: ${(lane-1) * 100 + 50}px;
        top: 0px;
        transition: transform 2s linear;
        z-index: 1000;
    `;

    this.gameArea.appendChild(note);
    console.log(`åˆ›å»ºéŸ³ç¬¦: è½¦é“ ${lane}`); // è°ƒè¯•æ—¥å¿—

    // è®©éŸ³ç¬¦ç§»åŠ¨åˆ°åº•éƒ¨
    setTimeout(() => {
        note.style.transform = `translateY(${this.gameArea.offsetHeight}px)`;
    }, 50);  // 50ms ç¡®ä¿ transition ç”Ÿæ•ˆ

    this.notes.push({
        element: note,
        lane: lane,
        active: true,
        hit: false
    });
}

updateNotes() {
    this.notes = this.notes.filter(note => {
        const rect = note.element.getBoundingClientRect();
        const gameAreaRect = this.gameArea.getBoundingClientRect();

        if (rect.bottom > gameAreaRect.bottom) { // éŸ³ç¬¦è¶…å‡ºèŒƒå›´
            note.element.remove();
            if (!note.hit) this.combo = 0;
            return false;
        }
        return true;
    });
    this.notes = this.notes.filter(note => note.active); // ä»…ä¿ç•™æœªç§»é™¤çš„éŸ³ç¬¦
}

  handleInput(e) {
    if (!this.isPlaying || !this.keyMap[e.key]) return;

    const lane = this.keyMap[e.key];
    const currentTime = performance.now();

    // æŸ¥æ‰¾å¯å‡»æ‰“çš„éŸ³ç¬¦
    const hitNote = this.notes.find(n =>
      n.active &&
      n.lane === lane &&
      !n.hit &&
      this.checkNotePosition(n.element)
    );

    if (hitNote) {
      this.processHit(hitNote);
    } else {
      this.combo = Math.max(0, this.combo - 1);
    }
  }

checkNotePosition(element) {
    const notePos = element.getBoundingClientRect();
    const gameAreaRect = this.gameArea.getBoundingClientRect();

    // åˆ¤å®šçª—å£å¤§å°
    return notePos.bottom >= gameAreaRect.bottom - 60 &&
           notePos.top <= gameAreaRect.bottom - 20;
}

  processHit(note) {
    note.hit = true;
    note.active = false;
    this.score += 100 + (this.combo * 50);
    this.combo++;

    // è§†è§‰åé¦ˆ
    note.element.style.background = '#FFFFFF';
    note.element.style.boxShadow = '0 0 15px rgba(255,255,255,0.8)';

    // ç²’å­æ•ˆæœ
    this.createParticleEffect(note.element);

    setTimeout(() => note.element.remove(), 100);
    this.updateDisplay();
  }

  createParticleEffect(sourceElement) {
    for(let i = 0; i < 8; i++) {
      const particle = document.createElement('div');
      const rect = sourceElement.getBoundingClientRect();

      particle.style.cssText = `
        width: 6px;
        height: 6px;
        background: ${sourceElement.style.background};
        position: absolute;
        left: ${rect.left + rect.width/2 - 3}px;
        top: ${rect.top + rect.height/2 - 3}px;
        border-radius: 50%;
        pointer-events: none;
      `;

      document.body.appendChild(particle);

      particle.animate([
        { transform: 'scale(1)', opacity: 1 },
        {
          transform: `translate(${Math.random()*60-30}px, ${Math.random()*60-30}px) scale(0)`,
          opacity: 0
        }
      ], {
        duration: 800,
        easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
      });

      setTimeout(() => particle.remove(), 800);
    }
  }

  updateDisplay() {
    document.getElementById('score').textContent = this.score;
    document.getElementById('combo').textContent = this.combo;

    this.checkUnlocks();

    if (this.score > this.highScore) {
      this.highScore = this.score;
      localStorage.setItem('njHighScore', this.highScore);
      this.renderHighScore();
    }
  }

checkUnlocks() {
    Object.keys(this.memberPhotos).forEach(score => {
        if (this.score >= score && !this.unlockedMembers.has(score)) {
            this.unlockedMembers.add(score);
            this.showUnlockedMember(score);
        }
    });
}
reset() {
    this.notes.forEach(n => n.element.remove());
    this.notes = [];

    this.score = 0;
    this.combo = 0;
    this.isPlaying = false;
    this.song.pause();
    this.song.currentTime = 0;

    this.updateDisplay();
}

addGameIcon() {
    const gameArea = document.getElementById('game-area');
    if (!gameArea) return;

    // è®¾ç½®èƒŒæ™¯å›¾
    gameArea.style.background = "black url('images/icons/game-icon.gif') no-repeat center center";
    gameArea.style.backgroundSize = "cover";
}

}
document.getElementById("show-guide-btn").addEventListener("click", () => {
    const guideWindow = document.getElementById("game-guide");
    guideWindow.style.display = "block";  // æ˜¾ç¤ºçª—å£

    // ç¦ç”¨æ¸¸æˆ & å…¶ä»–æ“ä½œ
    document.getElementById("start-game-btn").disabled = true;
    document.getElementById("show-guide-btn").disabled = true;
    document.getElementById("difficulty").disabled = true;
});

document.getElementById("close-guide-btn").addEventListener("click", () => {
    const guideWindow = document.getElementById("game-guide");
    guideWindow.style.display = "none";  // å…³é—­çª—å£

    // é‡æ–°å¯ç”¨æ¸¸æˆ & æŒ‰é’®
    document.getElementById("start-game-btn").disabled = false;
    document.getElementById("show-guide-btn").disabled = false;
    document.getElementById("difficulty").disabled = false;
});


   // åˆå§‹åŒ–æ¸¸æˆ
   const game = new RhythmGame();
document.querySelector('#start-game-btn').addEventListener('click', () => game.start());
document.addEventListener('keydown', (e) => game.handleInput(e));

// å›¾ç‰‡è·¯å¾„æ•°ç»„
const photos = [
    "images/group/group1.jpg",
    "images/group/group2.jpg",
    "images/group/group3.jpg",
    "images/group/group4.jpg",
    "images/group/group5.jpg"
];



let currentIndex = 0;

// æ›´æ–°å›¾ç‰‡æ˜¾ç¤º
function updatePhoto() {
    document.getElementById("group-photo").src = photos[currentIndex];
}

// åˆ‡æ¢åˆ°ä¸Šä¸€å¼ 
function prevPhoto() {
    currentIndex = (currentIndex - 1 + photos.length) % photos.length;
    updatePhoto();
}

// åˆ‡æ¢åˆ°ä¸‹ä¸€å¼ 
function nextPhoto() {
    currentIndex = (currentIndex + 1) % photos.length;
    updatePhoto();
}
function makeDraggable(element, handle) {
    let offsetX = 0, offsetY = 0, isDragging = false;

    handle.addEventListener("mousedown", (e) => {
        isDragging = true;
        offsetX = e.clientX - element.getBoundingClientRect().left;
        offsetY = e.clientY - element.getBoundingClientRect().top;
        element.style.zIndex = 999;
        document.body.style.userSelect = "none"; // é˜²æ­¢æ‹–åŠ¨æ—¶é€‰ä¸­æ–‡å­—
    });

    document.addEventListener("mousemove", (e) => {
        if (!isDragging) return;

        let newX = e.clientX - offsetX;
        let newY = e.clientY - offsetY;

        // è·å–è§†å£å°ºå¯¸
        const maxX = window.innerWidth - element.offsetWidth;
        const maxY = window.innerHeight - element.offsetHeight;

        // é™åˆ¶çª—å£åœ¨è§†å£å†…
        newX = Math.max(0, Math.min(newX, maxX));
        newY = Math.max(0, Math.min(newY, maxY));

        element.style.left = `${newX}px`;
        element.style.top = `${newY}px`;
    });

    document.addEventListener("mouseup", () => {
        isDragging = false;
        document.body.style.userSelect = "auto"; // å…è®¸å†æ¬¡é€‰ä¸­æ–‡å­—
    });
}

// ç»‘å®šæ‰€æœ‰å¯æ‹–åŠ¨çª—å£
window.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('.windows98-panel').forEach(win => {
        const titleBar = win.querySelector('.title-bar');
        if (titleBar) makeDraggable(win, titleBar);
    });

    // è§£ç»‘ unlocked-members çª—å£çš„ç‰¹æ®Šç»‘å®šï¼Œä½¿å…¶ç‹¬ç«‹
    const unlockedMembersWin = document.getElementById("unlocked-members");
    if (unlockedMembersWin) {
        unlockedMembersWin.style.position = "fixed"; // ç¡®ä¿å›ºå®šäºè§†å£
        const titleBar = unlockedMembersWin.querySelector('.title-bar');
        if (titleBar) makeDraggable(unlockedMembersWin, titleBar);
    }
});

    document.getElementById("close-members-btn").addEventListener("click", (e) => e.stopPropagation());
</script>
</body>
</html>
